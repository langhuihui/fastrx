{"version":3,"file":"filtering.js","sources":["../filtering.js"],"sourcesContent":["const {\r\n    Sink,\r\n    deliver,\r\n    noop\r\n} = require('./common')\r\nconst {\r\n    Filter\r\n} = require('./fusion')\r\nconst {\r\n    reduce\r\n} = require('./mathematical')\r\nexports.filter = f => source => sink => source(sink.fusionFilter ? sink.fusionFilter(f) : new Filter(sink, f))\r\n\r\nclass Ignore extends Sink {\r\n    next() { }\r\n}\r\nexports.ignoreElements = source => sink => source(new Ignore(sink))\r\n\r\nclass Take extends Sink {\r\n    init(count) {\r\n        this.count = count\r\n    }\r\n    next(data) {\r\n        this.sink.next(data)\r\n        if (--this.count === 0) {\r\n            this.defer()\r\n            this.complete()\r\n        }\r\n    }\r\n}\r\nexports.take = deliver(Take)\r\n\r\nclass TakeUntil extends Sink {\r\n    init(sSrc) {\r\n        this._takeUntil = new Sink(this.sink)\r\n        this._takeUntil.next = () => {\r\n            this.defer()\r\n            this.complete()\r\n        }\r\n        this._takeUntil.complete = noop\r\n        sSrc(this._takeUntil)\r\n    }\r\n    complete(err) {\r\n        //完成事件，单方面终结开关sink\r\n        this._takeUntil.dispose()\r\n        super.complete(err)\r\n    }\r\n}\r\n\r\nexports.takeUntil = deliver(TakeUntil)\r\n\r\nclass TakeWhile extends Sink {\r\n    init(f) {\r\n        this.f = f\r\n    }\r\n    next(data) {\r\n        const f = this.f\r\n        if (f(data)) {\r\n            this.sink.next(data)\r\n        } else {\r\n            this.defer()\r\n            this.complete()\r\n        }\r\n    }\r\n}\r\nexports.takeWhile = deliver(TakeWhile)\r\n\r\nexports.takeLast = count => reduce((buffer, d) => {\r\n    buffer.push(d)\r\n    if (buffer.length > count) buffer.shift()\r\n    return buffer\r\n}, [])\r\n\r\nclass Skip extends Sink {\r\n    init(count) {\r\n        this.count = count\r\n    }\r\n    next() {\r\n        if (--this.count === 0) {\r\n            this.next = super.next\r\n        }\r\n    }\r\n}\r\nexports.skip = deliver(Skip)\r\n\r\nclass _SkipUntil extends Sink {\r\n    next() {\r\n        this.dispose()\r\n        delete this.sourceSink.next\r\n    }\r\n    init(sourceSink) {\r\n        this.sourceSink = sourceSink\r\n    }\r\n}\r\n\r\nclass SkipUntil extends Sink {\r\n    init(sSrc) {\r\n        this._skipUntil = new _SkipUntil(null, this).subscribe(sSrc)\r\n        this.defer(this._skipUntil)\r\n        this.next = noop\r\n    }\r\n    complete(err) {\r\n        this._skipUntil.dispose()\r\n        super.complete(err)\r\n    }\r\n}\r\nexports.skipUntil = deliver(SkipUntil)\r\n\r\nclass SkipWhile extends Sink {\r\n    init(f) {\r\n        this.f = f\r\n    }\r\n    next(data) {\r\n        const f = this.f\r\n        if (!f(data)) {\r\n            this.next = super.next\r\n            this.next(data)\r\n        }\r\n    }\r\n}\r\nexports.skipWhile = deliver(SkipWhile)\r\n\r\nconst defaultThrottleConfig = {\r\n    leading: true,\r\n    trailing: false\r\n}\r\nclass _Throttle extends Sink {\r\n    init(durationSelector, trailing) {\r\n        this.durationSelector = durationSelector\r\n        this.trailing = trailing\r\n        this.hasValue = true\r\n        this.isComplete = false;\r\n    }\r\n    send(data) {\r\n        if (this.hasValue) {\r\n            this.sink.next(data)\r\n            this.isComplete = false\r\n            this.durationSelector(data)(this)\r\n        }\r\n        this.hasValue = false\r\n    }\r\n    next() {\r\n        this.complete()\r\n    }\r\n    complete() {\r\n        this.defer()\r\n        this.isComplete = true\r\n        if (this.trailing) {\r\n            this.send(this.last)\r\n        }\r\n    }\r\n}\r\nclass Throttle extends Sink {\r\n    init(durationSelector, config = defaultThrottleConfig) {\r\n        this.durationSelector = durationSelector\r\n        this.leading = config.leading\r\n        this.trailing = config.trailing\r\n        this.hasValue = false\r\n    }\r\n\r\n    throttle(data) {\r\n        this._throttle.isComplete = false\r\n        this._throttle.last = data\r\n        this._throttle.hasValue = true\r\n        this.durationSelector(data)(this._throttle)\r\n    }\r\n    next(data) {\r\n        if (!this._throttle || this._throttle.isComplete) {\r\n            if (!this._throttle) {\r\n                this._throttle = new _Throttle(this.sink, this.durationSelector, this.trailing)\r\n                this.defer(this._throttle)\r\n            }\r\n\r\n            if (this.leading) {\r\n                this.sink.next(data)\r\n                this.throttle(data)\r\n                this._throttle.hasValue = false\r\n            } else {\r\n                this.throttle(data)\r\n            }\r\n        } else {\r\n            this._throttle.last = data\r\n            this._throttle.hasValue = true\r\n        }\r\n    }\r\n    complete(err) {\r\n        if (err) {\r\n            this._throttle && this._throttle.dispose()\r\n            super.complete(err)\r\n        } else {\r\n            this._throttle && this._throttle.complete()\r\n            super.complete()\r\n        }\r\n    }\r\n}\r\nexports.throttle = deliver(Throttle)\r\nconst defaultAuditConfig = {\r\n    leading: false,\r\n    trailing: true\r\n}\r\nexports.audit = durationSelector => exports.throttle(durationSelector, defaultAuditConfig)\r\nclass ThrottleTime extends Sink {\r\n    init(period, config = defaultThrottleConfig) {\r\n        this.config = config\r\n        this.period = period\r\n        this.timerId = null\r\n    }\r\n    next(data) {\r\n        if (this.timerId) {\r\n            this.last = data\r\n            this.hasValue = true\r\n        } else {\r\n            this.timerId = setTimeout(() => {\r\n                this.timerId = null\r\n                if (this.config.trailing && this.hasValue) {\r\n                    this.sink.next(this.last)\r\n                }\r\n            }, this.period)\r\n            if (this.config.leading) {\r\n                this.sink.next(data)\r\n            } else {\r\n                this.last = data\r\n                this.hasValue = true\r\n            }\r\n        }\r\n    }\r\n    complete(err) {\r\n        if (!err) {\r\n            if (this.config.trailing && this.hasValue) {\r\n                this.sink.next(this.last)\r\n            }\r\n        }\r\n        super.complete(err)\r\n    }\r\n}\r\nexports.throttleTime = deliver(ThrottleTime)\r\nclass DebounceTime extends Sink {\r\n    init(period) {\r\n        this.period = period\r\n        this.timerId = null\r\n    }\r\n    next(data) {\r\n        this.buffer = data\r\n        if (this.timerId) {\r\n            clearTimeout(this.timerId)\r\n        }\r\n        this.timerId = setTimeout(() => {\r\n            this.sink.next(data)\r\n            this.timerId = null\r\n        }, this.period)\r\n    }\r\n    complete(error) {\r\n        if (this.timerId) {\r\n            clearTimeout(this.timerId)\r\n            if (!error && this.hasOwnProperty(\"buffer\")) {\r\n                this.sink.next(this.buffer)\r\n            }\r\n        }\r\n        super.complete(error)\r\n    }\r\n}\r\n\r\nexports.debounceTime = deliver(DebounceTime)\r\n\r\nclass _Debounce extends Sink {\r\n    next() {\r\n        this.complete()\r\n    }\r\n    complete(err) {\r\n        this.defer()\r\n        this.sink.next(this.last)\r\n        this.isComplete = true\r\n    }\r\n}\r\nclass Debounce extends Sink {\r\n    init(durationSelector) {\r\n        this.durationSelector = durationSelector\r\n    }\r\n    next(data) {\r\n        if (!this._debounce) {\r\n            this._debounce = new _Debounce(this.sink)\r\n            this.defer(this._debounce)\r\n        } else if (this._debounce.isComplete) {\r\n            this._debounce.isComplete = false\r\n        } else {\r\n            this._debounce.defer()\r\n        }\r\n        this.durationSelector(data)(this._debounce)\r\n        this._debounce.last = data\r\n    }\r\n    complete(err) {\r\n        if (err) {\r\n            this._debounce && this._debounce.dispose()\r\n            super.complete(err)\r\n        } else {\r\n            this._debounce && this._debounce.complete()\r\n            super.complete()\r\n        }\r\n    }\r\n}\r\n\r\nexports.debounce = deliver(Debounce)\r\nclass ElementAt extends Sink {\r\n    init(count, defaultValue) {\r\n        this.count = count\r\n        this.value = defaultValue\r\n    }\r\n    next(data) {\r\n        if (this.count-- === 0) {\r\n            this.sink.next(data)\r\n            this.defer()\r\n            super.complete()\r\n        }\r\n    }\r\n    complete(err) {\r\n        if (!err) {\r\n            if (this.value === void 0) err = new Error('not enough elements in sequence')\r\n            else this.sink.next(this.value)\r\n        }\r\n        super.complete(err)\r\n    }\r\n}\r\n\r\nexports.elementAt = deliver(ElementAt)\r\nexports.find = f => source => exports.take(1)(exports.skipWhile(d => !f(d))(source))\r\n\r\nclass FindIndex extends Sink {\r\n    init(f) {\r\n        this.f = f\r\n        this.i = 0\r\n    }\r\n    next(data) {\r\n        const f = this.f\r\n        if (f(data)) {\r\n            this.sink.next(this.i++)\r\n            this.defer()\r\n            this.complete()\r\n        } else {\r\n            ++this.i\r\n        }\r\n    }\r\n}\r\n\r\nexports.findIndex = deliver(FindIndex)\r\n\r\nclass First extends Sink {\r\n    init(f, defaultValue) {\r\n        this.f = f\r\n        this.value = defaultValue\r\n        this.count = 0\r\n    }\r\n    next(data) {\r\n        const f = this.f\r\n        if (!f || f(data, this.count++)) {\r\n            this.value = data\r\n            this.defer()\r\n            this.complete()\r\n        }\r\n    }\r\n    complete(err) {\r\n        if (!err) {\r\n            if (this.value === void 0) err = new Error('no elements in sequence')\r\n            else this.sink.next(this.value)\r\n        }\r\n        super.complete(err)\r\n    }\r\n}\r\n\r\nexports.first = deliver(First)\r\n\r\nclass Last extends Sink {\r\n    init(f, defaultValue) {\r\n        this.f = f\r\n        this.value = defaultValue\r\n        this.count = 0\r\n    }\r\n    next(data) {\r\n        const f = this.f\r\n        if (!f || f(data, this.count++)) {\r\n            this.value = data\r\n        }\r\n    }\r\n    complete(err) {\r\n        if (!err) {\r\n            if (this.value === void 0) err = new Error('no elements in sequence')\r\n            else this.sink.next(this.value)\r\n        }\r\n        super.complete(err)\r\n    }\r\n}\r\n\r\nexports.last = deliver(Last)"],"names":["require","Sink","deliver","noop","Filter","reduce","exports","filter","f","source","sink","fusionFilter","Ignore","ignoreElements","Take","count","data","next","defer","complete","take","TakeUntil","sSrc","_takeUntil","err","dispose","takeUntil","TakeWhile","takeWhile","takeLast","buffer","d","push","length","shift","Skip","skip","_SkipUntil","sourceSink","SkipUntil","_skipUntil","subscribe","skipUntil","SkipWhile","skipWhile","defaultThrottleConfig","leading","trailing","_Throttle","durationSelector","hasValue","isComplete","send","last","Throttle","config","_throttle","throttle","defaultAuditConfig","audit","ThrottleTime","period","timerId","setTimeout","throttleTime","DebounceTime","clearTimeout","error","hasOwnProperty","debounceTime","_Debounce","Debounce","_debounce","debounce","ElementAt","defaultValue","value","Error","elementAt","find","FindIndex","i","findIndex","First","first","Last"],"mappings":"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"}
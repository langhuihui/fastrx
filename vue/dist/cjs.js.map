{"version":3,"file":"cjs.js","sources":["../vue3.js","../index.js"],"sourcesContent":["import { watch as _watch, customRef, onUnmounted } from 'vue'\nexport const eventHandler = (once) => {\n    const observers = new Set()\n    const observable = sink => {\n        observers.add(sink)\n        sink.defer([observers.delete, observers, sink])\n    }\n    if (once)\n        observable.handler = (...args) => {\n            const arg = args.length > 1 ? args : args[0]\n            observers.forEach(observer => {\n                observer.next(arg)\n                observer.complete()\n            })\n        }\n    else\n        observable.handler = (...args) => {\n            const arg = args.length > 1 ? args : args[0]\n            observers.forEach(observer => observer.next(arg))\n        }\n    return observable\n}\nexport const fromLifeHook = (hook, once = true) => hook(eventHandler(once).handler)\nexport const watch = (target, option) => sink => sink.defer(_watch(target, (value) => sink.next(value), option))\nexport const toRef = () => source => customRef((track, trigger) => {\n    const sink = new Sink()\n    let value;\n    sink.next = d => (value = d, trigger())\n    source(sink)\n    onUnmounted(() => sink.dispose())\n    return {\n        get() {\n            track()\n            return value\n        },\n        set(value) {\n            //nothing to do\n        }\n    }\n})","import rx from 'fastrx'\nimport * as vue3 from './vue3'\nexport default Object.assign(rx, vue3)"],"names":["eventHandler","once","observers","Set","observable","sink","add","defer","delete","handler","args","arg","length","forEach","observer","next","complete","fromLifeHook","hook","watch","target","option","_watch","value","toRef","source","customRef","track","trigger","Sink","d","onUnmounted","dispose","get","set","Object","assign","rx","vue3"],"mappings":";;;;;;;;;AACO,MAAMA,YAAY,GAAIC,IAAD,IAAU;AAClC,QAAMC,SAAS,GAAG,IAAIC,GAAJ,EAAlB;;AACA,QAAMC,UAAU,GAAGC,IAAI,IAAI;AACvBH,IAAAA,SAAS,CAACI,GAAV,CAAcD,IAAd;AACAA,IAAAA,IAAI,CAACE,KAAL,CAAW,CAACL,SAAS,CAACM,MAAX,EAAmBN,SAAnB,EAA8BG,IAA9B,CAAX;AACH,GAHD;;AAIA,MAAIJ,IAAJ,EACIG,UAAU,CAACK,OAAX,GAAqB,CAAC,GAAGC,IAAJ,KAAa;AAC9B,UAAMC,GAAG,GAAGD,IAAI,CAACE,MAAL,GAAc,CAAd,GAAkBF,IAAlB,GAAyBA,IAAI,CAAC,CAAD,CAAzC;AACAR,IAAAA,SAAS,CAACW,OAAV,CAAkBC,QAAQ,IAAI;AAC1BA,MAAAA,QAAQ,CAACC,IAAT,CAAcJ,GAAd;AACAG,MAAAA,QAAQ,CAACE,QAAT;AACH,KAHD;AAIH,GAND,CADJ,KASIZ,UAAU,CAACK,OAAX,GAAqB,CAAC,GAAGC,IAAJ,KAAa;AAC9B,UAAMC,GAAG,GAAGD,IAAI,CAACE,MAAL,GAAc,CAAd,GAAkBF,IAAlB,GAAyBA,IAAI,CAAC,CAAD,CAAzC;AACAR,IAAAA,SAAS,CAACW,OAAV,CAAkBC,QAAQ,IAAIA,QAAQ,CAACC,IAAT,CAAcJ,GAAd,CAA9B;AACH,GAHD;AAIJ,SAAOP,UAAP;AACH,CApBM;AAqBA,MAAMa,YAAY,GAAG,CAACC,IAAD,EAAOjB,IAAI,GAAG,IAAd,KAAuBiB,IAAI,CAAClB,YAAY,CAACC,IAAD,CAAZ,CAAmBQ,OAApB,CAAhD;AACA,MAAMU,KAAK,GAAG,CAACC,MAAD,EAASC,MAAT,KAAoBhB,IAAI,IAAIA,IAAI,CAACE,KAAL,CAAWe,SAAM,CAACF,MAAD,EAAUG,KAAD,IAAWlB,IAAI,CAACU,IAAL,CAAUQ,KAAV,CAApB,EAAsCF,MAAtC,CAAjB,CAA1C;AACA,MAAMG,KAAK,GAAG,MAAMC,MAAM,IAAIC,aAAS,CAAC,CAACC,KAAD,EAAQC,OAAR,KAAoB;AAC/D,QAAMvB,IAAI,GAAG,IAAIwB,IAAJ,EAAb;AACA,MAAIN,KAAJ;;AACAlB,EAAAA,IAAI,CAACU,IAAL,GAAYe,CAAC,KAAKP,KAAK,GAAGO,CAAR,EAAWF,OAAO,EAAvB,CAAb;;AACAH,EAAAA,MAAM,CAACpB,IAAD,CAAN;AACA0B,EAAAA,eAAW,CAAC,MAAM1B,IAAI,CAAC2B,OAAL,EAAP,CAAX;AACA,SAAO;AACHC,IAAAA,GAAG,GAAG;AACFN,MAAAA,KAAK;AACL,aAAOJ,KAAP;AACH,KAJE;;AAKHW,IAAAA,GAAG,CAACX,KAAD,EAAQ;AAEV;;AAPE,GAAP;AASH,CAf6C,CAAvC;;;;;;;;;;ACtBP,YAAeY,MAAM,CAACC,MAAP,CAAcC,sBAAd,EAAkBC,IAAlB,CAAf;;;;"}